\begin{tikzpicture}
\fill [color=white,opacity=0] (0, 0) rectangle (12, -10);

\node at (0.4, -1.25) [font=\fontsize{12pt}{20pt}\selectfont] {(1)};
\node at (9.6, -1.25) [font=\fontsize{12pt}{20pt}\selectfont] {初始状态};
\draw (1.2, -0.9) rectangle (6.8, -1.6);
\draw (2, -0.9) -- (2, -1.6);
\draw (2.8, -0.9) -- (2.8, -1.6);
\draw (3.6, -0.9) -- (3.6, -1.6);
\draw (4.4, -0.9) -- (4.4, -1.6);
\draw (5.2, -0.9) -- (5.2, -1.6);
\draw (6, -0.9) -- (6, -1.6);
\draw (1.2, -0.9) -- (2, -1.6);
\draw (1.2, -1.6) -- (2, -0.9);
\draw (2, -0.9) -- (2.8, -1.6);
\draw (2, -1.6) -- (2.8, -0.9);
\node at (3.2, -0.25) [font=\fontsize{12pt}{20pt}\selectfont] {$read\_index$};
\node at (3.2, -2.25) [font=\fontsize{12pt}{20pt}\selectfont] {$write\_index$};
\draw [-latex] (3.2, -0.5) -- (3.2, -0.9);
\draw [-latex] (3.2, -2) -- (3.2, -1.6);
\node at (0.4, -3.75) [font=\fontsize{12pt}{20pt}\selectfont] {(2)};
\node at (9.6, -3.75) [font=\fontsize{12pt}{20pt}\selectfont] {申请空间（原子操作）};
\draw (1.2, -3.4) rectangle (6.8, -4.1);
\draw (2, -3.4) -- (2, -4.1);
\draw (2.8, -3.4) -- (2.8, -4.1);
\draw (3.6, -3.4) -- (3.6, -4.1);
\draw (4.4, -3.4) -- (4.4, -4.1);
\draw (5.2, -3.4) -- (5.2, -4.1);
\draw (6, -3.4) -- (6, -4.1);
\draw (1.2, -3.4) -- (2, -4.1);
\draw (1.2, -4.1) -- (2, -3.4);
\draw (2, -3.4) -- (2.8, -4.1);
\draw (2, -4.1) -- (2.8, -3.4);
\node at (3.2, -2.75) [font=\fontsize{12pt}{20pt}\selectfont] {$read\_index$};
\node at (4, -4.75) [font=\fontsize{12pt}{20pt}\selectfont] {$write\_index$};
\draw [-latex] (3.2, -3) -- (3.2, -3.4);
\draw [-latex] (4, -4.5) -- (4, -4.1);
\node at (0.4, -6.25) [font=\fontsize{12pt}{20pt}\selectfont] {(3)};
\node at (9.6, -6.25) [font=\fontsize{12pt}{20pt}\selectfont] {写入数据};
\draw (1.2, -5.9) rectangle (6.8, -6.6);
\draw (2, -5.9) -- (2, -6.6);
\draw (2.8, -5.9) -- (2.8, -6.6);
\draw (3.6, -5.9) -- (3.6, -6.6);
\draw (4.4, -5.9) -- (4.4, -6.6);
\draw (5.2, -5.9) -- (5.2, -6.6);
\draw (6, -5.9) -- (6, -6.6);
\draw (1.2, -5.9) -- (2, -6.6);
\draw (1.2, -6.6) -- (2, -5.9);
\draw (2, -5.9) -- (2.8, -6.6);
\draw (2, -6.6) -- (2.8, -5.9);
\draw (2.8, -5.9) -- (3.6, -6.6);
\draw (2.8, -6.6) -- (3.6, -5.9);
\node at (3.2, -5.25) [font=\fontsize{12pt}{20pt}\selectfont] {$read\_index$};
\node at (4, -7.25) [font=\fontsize{12pt}{20pt}\selectfont] {$write\_index$};
\draw [-latex] (3.2, -5.5) -- (3.2, -5.9);
\draw [-latex] (4, -7) -- (4, -6.6);
\node at (0.4, -8.75) [font=\fontsize{12pt}{20pt}\selectfont] {(4)};
\node at (9.6, -8.75) [font=\fontsize{12pt}{20pt}\selectfont] {完成写入（原子操作）};
\draw (1.2, -8.4) rectangle (6.8, -9.1);
\draw (2, -8.4) -- (2, -9.1);
\draw (2.8, -8.4) -- (2.8, -9.1);
\draw (3.6, -8.4) -- (3.6, -9.1);
\draw (4.4, -8.4) -- (4.4, -9.1);
\draw (5.2, -8.4) -- (5.2, -9.1);
\draw (6, -8.4) -- (6, -9.1);
\draw (1.2, -8.4) -- (2, -9.1);
\draw (1.2, -9.1) -- (2, -8.4);
\draw (2, -8.4) -- (2.8, -9.1);
\draw (2, -9.1) -- (2.8, -8.4);
\draw (2.8, -8.4) -- (3.6, -9.1);
\draw (2.8, -9.1) -- (3.6, -8.4);
\node at (4, -7.75) [font=\fontsize{12pt}{20pt}\selectfont] {$read\_index$};
\node at (4, -9.75) [font=\fontsize{12pt}{20pt}\selectfont] {$write\_index$};
\draw [-latex] (4, -8) -- (4, -8.4);
\draw [-latex] (4, -9.5) -- (4, -9.1);
\end{tikzpicture}
